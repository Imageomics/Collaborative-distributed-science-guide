# Git Cherry-pick update for Downstream Repos

A step-by-step guide to updating repositories based on the template guide repo:

Before you start, you should know which commits are going to be pulled from the template repo. Collect their hashes in a separate text file; be sure to list them in chronological order, so they can be applied correctly.

1. Ensure the target repo is up-to-date.
2. Create a new branch onto which to pull the changes:

    ```console
    git checkout -b dev
    ```

3. Check the remotes available for your repo:

    ```console
    git remote -v
    ```

    !!! note
        If you haven't updated yet, you will only see the current repo options (`origin`):

        ```console
        origin	git@github.com:Imageomics/Imageomics-guide.git (fetch)
        origin	git@github.com:Imageomics/Imageomics-guide.git (push)
        ```

        In which case, run the following to add the template guide as an available remote under the title `upstream`:

        ```console
        git remote add upstream git@github.com:Imageomics/Collaborative-distributed-science-guide.git
        ```

        After running `git remote -v`, you should then see

        ```console
        origin	git@github.com:Imageomics/Imageomics-guide.git (fetch)
        origin	git@github.com:Imageomics/Imageomics-guide.git (push)
        upstream	git@github.com:Imageomics/Collaborative-distributed-science-guide.git (fetch)
        upstream	git@github.com:Imageomics/Collaborative-distributed-science-guide.git (push)
        ```

4. Run `git fetch upstream` to get the commits from the template repo (now recognized as `upstream`).
5. Run `git cherry-pick <first-commit-hash>`, ex:

    ```console
    git cherry-pick 22afb3bcafeefe25bb9f9d5a96b4ac109b9d04cc
    ```

    !!! note
        If you have a merge commit, open the file, resolve the conflict, and then `git add` the file. From that point you should be able to run `git cherry-pick --continue` and it will provide the commit message from the upstream. Checking `git status` and `git log` at various points in this process will allow you to check on how these are progressing and see the addition of the upstream commits to your current repo's branch.

6. Once you've collected all the upstream commits, run `git push --set-upstream origin dev` to add them to the current repo.
7. Open a pull request from the `dev` branch to add these upstream commits to `main`. Be sure to include a description of the commits, where they came from, and include links to PRs _from the upstream repo_. Auto-links generated by GitHub (based on `#<issue/PR-number>`) will link to that number issue or PR in the current repo, not the upstream one.

8. Merge commit the PR&mdash;**Do Not** squash or rebase the PR, then you would lose the ability to find the original source and context for the selected commits (the purpose of using a `git cherry-pick` instead of just adding the file).
